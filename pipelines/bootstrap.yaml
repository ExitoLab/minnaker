# file: pipeline-stage-deploy-manifest.yaml
apiVersion: pacrd.armory.spinnaker.io/v1alpha1
kind: Pipeline
metadata:
  name: pacrd-deploymanifest-samples
spec:
  description: A sample showing how to define artifacts.
  application: &app-name armory-samples
  expectedArtifacts:
          #    - id: &image-id armory-samples
          #      displayName: *image-id armory-samples
          #      matchArtifact: &manifest-repo-artifact
        type: git/repo
        properties:
          name: my-organization/my-container
          artifactAccount: gitrepo
          metadata:
            subPath: "/armory-samples"
          reference: https://github.com/armory.minnaker.git
      defaultArtifact:
        customKind: true
        <<: *manifest-repo-artifact
      useDefaultArtifact: false
      usePriorArtifact: false 
# trigger:
#    - type: cron
#      properties:
#        enabled: true
#        cronExpression: 0 0 8 1/1 * ? *
  stages:
- expectedArtifacts:
  - defaultArtifact:
      customKind: true
    displayName: soft-fireant-82
    matchArtifact:
      artifactAccount: embedded-artifact
      customKind: false
      type: embedded/base64
    useDefaultArtifact: false
    usePriorArtifact: false
  inputArtifact:
    account: gitrepo
    artifact:
      artifactAccount: gitrepo
      customKind: true
      reference: https://github.com/armory/minnaker.git
      type: git/repo
      version: pacrd
  kustomizeFilePath: pipelines/kustomization.yaml
  name: Bake Bootstrap
  overrides: {}
  refId: '1'
  requisiteStageRefIds: []
  templateRenderer: KUSTOMIZE
  type: bakeManifest
- failPipeline: true
  judgmentInputs: []
  name: Manual Judgment
  notifications: []
  refId: '2'
  requisiteStageRefIds:
  - '3'
  type: manualJudgment
- account: spinnaker
  cloudProvider: kubernetes
  moniker:
    app: test
  name: Deploy Bootstrap
  namespaceOverride: spinnaker
  refId: '3'
  requisiteStageRefIds:
  - '1'
  skipExpressionEvaluation: false
  source: artifact
  trafficManagement:
    enabled: false
    options:
      enableTraffic: false
      services: []
  type: deployManifest
triggers:
- enabled: true